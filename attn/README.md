attention abstractions (MHA/GQA/MQA), KV-cache interfaces, masking logic